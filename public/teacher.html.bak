<!doctype html><html lang="tr"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Öğretmen</title><link rel="stylesheet" href="style.css"></head><body><div class="container"><div class="card"><h1>Öğretmen Paneli</h1><p class="small">Varsayılan: ogretmen / Etathlon!2025</p><div><label>Kullanıcı</label><input id="username" value="ogretmen"></div><div><label>Şifre</label><input id="password" type="password" value="Etathlon!2025"></div><div style="margin-top:8px"><button id="loginBtn">Giriş</button><span id="msg"></span></div></div><div id="panel" style="display:none"></div></div><script>let token=localStorage.getItem('token')||null;function hdr(){return token?{'Content-Type':'application/json','Authorization':'Bearer '+token}:{'Content-Type':'application/json'};}async function login(){const u=document.getElementById('username').value.trim();const p=document.getElementById('password').value.trim();const r=await fetch('/api/auth/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({username:u,password:p})});const d=await r.json();if(d.token){token=d.token;localStorage.setItem('token',token);document.querySelector('.card').style.display='none';loadPanel();}else document.getElementById('msg').textContent=d.error;}document.getElementById('loginBtn').addEventListener('click',login);async function loadPanel(){document.getElementById('panel').style.display='block';document.getElementById('panel').innerHTML=`<div class='card'><h2>Metin Ekle</h2><div><label>Başlık</label><input id='title'></div><div><label>Süre</label><input id='duration' type='number' value='60'></div><div><label>Metin</label><textarea id='content'></textarea></div><div style='margin-top:8px'><button id='saveText'>Kaydet</button></div></div><div class='card'><h2>Metinler</h2><div id='texts'></div></div><div class='card'><h2>Okumalar</h2><div id='readings'></div></div>`; document.getElementById('saveText').addEventListener('click',async ()=>{const title=document.getElementById('title').value.trim();const content=document.getElementById('content').value.trim();const duration=parseInt(document.getElementById('duration').value,10);if(!title||!content||!duration) return alert('doldurun');await fetch('/api/texts',{method:'POST',headers:hdr(),body:JSON.stringify({title,content,duration_sec:duration})}); loadTexts();}); loadTexts(); loadReadings(); } async function loadTexts(){const r=await fetch('/api/texts');const rows=await r.json(); const wrap=document.getElementById('texts'); wrap.innerHTML=''; rows.forEach(x=>{const div=document.createElement('div');div.style.display='flex';div.style.justifyContent='space-between';div.style.padding='8px 0';div.innerHTML=`<div><strong>${x.title}</strong> <span class='small'>${x.duration_sec} sn</span></div><div><button data-id='${x.id}' class='del'>Sil</button></div>`;wrap.appendChild(div);} ); document.querySelectorAll('.del').forEach(b=>b.addEventListener('click',async e=>{if(!confirm('Sil?')) return; await fetch('/api/texts/'+e.target.dataset.id,{method:'DELETE',headers:hdr()}); loadTexts(); loadReadings(); })); } async function loadReadings(){const r=await fetch('/api/readings'); const rows=await r.json(); const wrap=document.getElementById('readings'); wrap.innerHTML=''; rows.forEach(rw=>{const div=document.createElement('div');div.style.padding='8px 0';div.innerHTML=`<div style='display:flex;justify-content:space-between'><div><strong>${rw.student_name}</strong> — ${rw.title} <span class='small'>${rw.wpm} k/dk • ${rw.errors} hata</span></div><div><a href='reading_detail.html?id=${rw.id}'><button>Detay</button></a></div></div>`; wrap.appendChild(div); }); }</script></body></html>